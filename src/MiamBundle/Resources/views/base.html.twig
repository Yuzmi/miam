<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>{% block head_title %}Miam{% endblock %}</title>
		<link rel="icon" href="{{ asset('favicon.ico') }}" />
		
		{% stylesheets "@MiamBundle/Resources/public/css/*.css" %}
			<link href="{{ asset_url }}" type="text/css" rel="stylesheet">
		{% endstylesheets %}

		{% block stylesheets %}
			{% stylesheets "@MiamBundle/Resources/public/scss/main.scss" filter='scss' output='css/main.css' %}
				<link href="{{ asset_url }}" type="text/css" rel="stylesheet">
			{% endstylesheets %}
		{% endblock %}
	</head>
	<body>
		<noscript>Y U DO THAT TO ME !? PLEASE DISABLE NOSCRIPT ! :-(</noscript>

		{% block body %}{% endblock %}
		
		<div class="flashMessages">
			{% set fmTypes = ["success", "notice", "warning", "error"] %}

			{% for type in fmTypes %}
				{% for fm in app.session.flashbag.get(type) %}
					<div class="flashMessageContainer">
						<div class="flashMessage success">{{ fm }}</div>
					</div>
				{% endfor %}
			{% endfor %}
		</div>

		{% if not app.user %}
			{% include "MiamBundle:Security:popup_login.html.twig" %}

			{% include "MiamBundle:Security:popup_register.html.twig" %}
		{% endif %}

		{% block javascripts %}
			{% javascripts
				"@MiamBundle/Resources/public/js/jquery.js"
				"@MiamBundle/Resources/public/js/main.js"
				"@MiamBundle/Resources/public/js/items.js"
			%}
				<script src="{{ asset_url }}"></script>
			{% endjavascripts %}

			<script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
			<script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>

			<script>
				app.preInit = function() {
					app.dateLoaded = '{{ "now"|date() }}';

					{% if app.user %}
						app.user = { 'id': {{ app.user.id }} };
					{% else %}
						app.user = false;
					{% endif %}
				}
			</script>
		{% endblock %}
	</body>
</html>